<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Currency Converter with Voice</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f7fa;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: #333;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            width: 90%;
            max-width: 900px;
            text-align: center;
        }
        h1 {
            font-size: 1.8em;
            margin-bottom: 20px;
            color: #007bff;
        }
        label {
            display: block;
            text-align: left;
            margin-top: 10px;
            font-weight: bold;
        }
        input[type="number"] {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            box-sizing: border-box;
        }
        select {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            background-color: #fff;
            appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23007CB2%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095.1c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.9z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 12px top 50%;
            background-size: 12px auto;
        }
        button {
            width: 100%;
            padding: 12px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: background-color 0.3s;
            margin: 10px 0;
        }
        button:hover {
            background-color: #0056b3;
        }
        .voice-btn {
            background-color: #ff6f61;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .voice-btn:hover {
            background-color: #e55a50;
        }
        .voice-btn img {
            width: 20px;
            height: 20px;
        }
        #result {
            margin-top: 20px;
            font-size: 1.2em;
            color: #28a745;
            word-wrap: break-word;
        }
        .swap {
            background-color: #6c757d;
        }
        .swap:hover {
            background-color: #5a6268;
        }
        .words {
            font-style: italic;
            color: #666;
            margin-top: 10px;
        }
        .flag {
            width: 100%;
            max-width: 200px;
            height: auto;
            margin: 10px auto;
            display: block;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .ad-container {
            margin: 20px 0;
            width: 100%;
            text-align: center;
        }
        @media (min-width: 600px) {
            .converter {
                display: flex;
                justify-content: space-between;
                align-items: flex-start;
            }
            .input-section, .output-section {
                width: 45%;
            }
            .controls {
                display: flex;
                flex-direction: column;
                justify-content: center;
                margin: 0 20px;
            }
            .controls button {
                width: auto;
                padding: 12px 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Currency Converter</h1>
        <!-- AdSense Ad 1 -->
        <div class="ad-container">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-1234567890123456"
                 data-ad-slot="1234567890"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
        </div>
        <div class="converter">
            <div class="input-section">
                <label for="amount">Amount:</label>
                <input type="number" id="amount" placeholder="Enter amount" min="0" step="0.01">
                <button class="voice-btn" onclick="startVoiceInput()">
                    <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiNmZmZmZmYiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMTIgMjNBNCA0IDAgMCAxIDggMTlsLTUtNSAyLTIiLz48cGF0aCBkPSJNMTIgMTNhOSA5IDAgMCAxIDAtMThhOSA5IDAgMCAxIDAgMThaIi8+PHBhdGggZD0iTTE2IDE5bDUgNS0yIDIiLz48L3N2Zz4=" alt="Microphone">
                    Voice Input
                </button>
                <label for="fromCurrency">From:</label>
                <select id="fromCurrency"></select>
                <img id="fromFlag" class="flag" alt="From Currency Representation">
                <div id="inputWords" class="words"></div>
            </div>
            <div class="controls">
                <button class="swap" onclick="swapCurrencies()">Swap</button>
                <button onclick="convertCurrency()">Convert</button>
                <button class="voice-btn" onclick="speakResult()">
                    <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiNmZmZmZmYiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMTcgMTJhMyAzIDAgMCAxIDAgNkgzIi8+PHBhdGggZD0iTTE1IDYuMXYxMC44Ii8+PHBhdGggZD0iTTIxIDExLjVsLTIgMi4xYzEuMSAxLjMgLjQuMyAwIDBMMjEgMTIiLz48L3N2Zz4=" alt="Speaker">
                    Speak Result
                </button>
            </div>
            <div class="output-section">
                <label for="toCurrency">To:</label>
                <select id="toCurrency"></select>
                <div id="result"></div>
                <img id="toFlag" class="flag" alt="To Currency Representation">
                <div id="outputWords" class="words"></div>
            </div>
        </div>
        <!-- AdSense Ad 2 -->
        <div class="ad-container">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-1234567890123456"
                 data-ad-slot="0987654321"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
        </div>
    </div>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1234567890123456" crossorigin="anonymous"></script>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
    <script>
        const pixabayApiKey = ''; // Get your free API key from https://pixabay.com/api/docs/ after signing up
        let currencies = [];
        const noPlural = ['yen', 'won', 'baht', 'dong', 'kip', 'tala', 'guarani', 'vatu', 'tugrik', 'riyal', 'dirham', 'dinar', 'lira', 'afghani', 'leone', 'lilangeni', 'loti', 'pataca', 'pula', 'rand', 'riel', 'rufiyaa', 'rupiah', 'shekel', 'shilling', 'som', 'somoni', 'tugrik'];

        const units = ["", "one", "two", "three", "four", "five", "six", "seven", "eight", "nine", "ten", "eleven", "twelve", "thirteen", "fourteen", "fifteen", "sixteen", "seventeen", "eighteen", "nineteen"];
        const tens = ["", "", "twenty", "thirty", "forty", "fifty", "sixty", "seventy", "eighty", "ninety"];
        const thousands = ["", "thousand", "million", "billion"];

        function numberToWords(num) {
            if (num === 0) return "zero";
            let i = 0;
            let words = "";
            while (num > 0) {
                if (num % 1000 !== 0) {
                    words = helper(num % 1000) + thousands[i] + " " + words;
                }
                num = Math.floor(num / 1000);
                i++;
            }
            return words.trim();
        }

        function helper(num) {
            if (num === 0) return "";
            if (num < 20) return units[num] + " ";
            if (num < 100) return tens[Math.floor(num / 10)] + " " + helper(num % 10);
            return units[Math.floor(num / 100)] + " hundred " + helper(num % 100);
        }

        function getPluralName(baseName, amount) {
            if (Math.floor(amount) === 1) return baseName;
            const lastWord = baseName.split(' ').pop().toLowerCase();
            if (noPlural.includes(lastWord)) return baseName;
            return baseName.replace(new RegExp(lastWord + '$', 'i'), lastWord + 's');
        }

        async function fetchCurrencies() {
            try {
                const response = await fetch('https://restcountries.com/v3.1/all?fields=currencies,flags');
                const data = await response.json();
                const currencyMap = new Map();
                data.forEach(country => {
                    if (country.currencies && country.flags.png) {
                        Object.entries(country.currencies).forEach(([code, info]) => {
                            if (!currencyMap.has(code) && info.name) {
                                currencyMap.set(code, { name: info.name, flag: country.flags.png });
                            }
                        });
                    }
                });
                currencies = Array.from(currencyMap).map(([code, details]) => ({ code, ...details })).sort((a, b) => a.name.localeCompare(b.name));
                populateSelects();
            } catch (error) {
                console.error('Error fetching currencies:', error);
            }
        }

        function populateSelects() {
            const fromSelect = document.getElementById('fromCurrency');
            const toSelect = document.getElementById('toCurrency');
            currencies.forEach(currency => {
                const option1 = document.createElement('option');
                option1.value = currency.code;
                option1.textContent = `${currency.name} (${currency.code})`;
                fromSelect.appendChild(option1);
                const option2 = option1.cloneNode(true);
                toSelect.appendChild(option2);
            });
            fromSelect.value = 'USD';
            toSelect.value = 'EUR';
            document.getElementById('amount').value = 1;
            convertCurrency();
        }

        async function updateImages() {
            const from = document.getElementById('fromCurrency').value;
            const to = document.getElementById('toCurrency').value;
            const fromData = currencies.find(c => c.code === from);
            const toData = currencies.find(c => c.code === to);
            let fromImg = fromData ? fromData.flag : '';
            let toImg = toData ? toData.flag : '';
            if (pixabayApiKey) {
                try {
                    const fromRes = await fetch(`https://pixabay.com/api/?key=${pixabayApiKey}&q=${encodeURIComponent(fromData.name + ' banknote')}&image_type=photo&safesearch=true&per_page=3`);
                    const fromImgData = await fromRes.json();
                    if (fromImgData.hits && fromImgData.hits.length > 0) {
                        fromImg = fromImgData.hits[0].webformatURL;
                    }
                    const toRes = await fetch(`https://pixabay.com/api/?key=${pixabayApiKey}&q=${encodeURIComponent(toData.name + ' banknote')}&image_type=photo&safesearch=true&per_page=3`);
                    const toImgData = await toRes.json();
                    if (toImgData.hits && toImgData.hits.length > 0) {
                        toImg = toImgData.hits[0].webformatURL;
                    }
                } catch (error) {
                    console.error('Error fetching images from Pixabay:', error);
                }
            }
            document.getElementById('fromFlag').src = fromImg;
            document.getElementById('fromFlag').alt = `${fromData.name} Representation`;
            document.getElementById('toFlag').src = toImg;
            document.getElementById('toFlag').alt = `${toData.name} Representation`;
        }

        async function convertCurrency() {
            const amount = parseFloat(document.getElementById('amount').value);
            const from = document.getElementById('fromCurrency').value;
            const to = document.getElementById('toCurrency').value;
            const resultDiv = document.getElementById('result');
            const inputWordsDiv = document.getElementById('inputWords');
            const outputWordsDiv = document.getElementById('outputWords');

            if (isNaN(amount) || amount <= 0) {
                resultDiv.textContent = 'Please enter a valid amount.';
                inputWordsDiv.textContent = '';
                outputWordsDiv.textContent = '';
                return;
            }

            try {
                const response = await fetch(`https://open.er-api.com/v6/latest/${from}`);
                const data = await response.json();
                if (data.result !== 'success') {
                    throw new Error('API error');
                }
                const rate = data.rates[to];
                const converted = (amount * rate).toFixed(2);
                resultDiv.textContent = `${amount.toFixed(2)} ${from} = ${converted} ${to}`;

                const fromData = currencies.find(c => c.code === from);
                const toData = currencies.find(c => c.code === to);

                // Input words
                const inputInteger = Math.floor(amount);
                const inputDecimal = Math.round((amount - inputInteger) * 100);
                let inputWords = numberToWords(inputInteger);
                const inputName = getPluralName(fromData.name, amount);
                inputWords += ` ${inputName}`;
                if (inputDecimal > 0) {
                    inputWords += ` and ${inputDecimal} cents`;
                }
                inputWordsDiv.textContent = inputWords;

                // Output words
                const outputAmount = parseFloat(converted);
                const outputInteger = Math.floor(outputAmount);
                const outputDecimal = Math.round((outputAmount - outputInteger) * 100);
                let outputWords = numberToWords(outputInteger);
                const outputName = getPluralName(toData.name, outputAmount);
                outputWords += ` ${outputName}`;
                if (outputDecimal > 0) {
                    outputWords += ` and ${outputDecimal} cents`;
                }
                outputWordsDiv.textContent = outputWords;

            } catch (error) {
                resultDiv.textContent = 'Error fetching exchange rate.';
                inputWordsDiv.textContent = '';
                outputWordsDiv.textContent = '';
                console.error(error);
            }
            await updateImages();
        }

        function swapCurrencies() {
            const fromSelect = document.getElementById('fromCurrency');
            const toSelect = document.getElementById('toCurrency');
            const temp = fromSelect.value;
            fromSelect.value = toSelect.value;
            toSelect.value = temp;
            convertCurrency();
        }

        function startVoiceInput() {
            if (!('webkitSpeechRecognition' in window)) {
                alert('Sorry, your browser does not support speech recognition.');
                return;
            }
            const recognition = new webkitSpeechRecognition();
            recognition.lang = 'en-US';
            recognition.interimResults = false;
            recognition.maxAlternatives = 1;

            recognition.onstart = () => {
                document.querySelector('.voice-btn').style.backgroundColor = '#e55a50';
            };
            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                const amountMatch = transcript.match(/\d+(\.\d+)?/);
                if (amountMatch) {
                    document.getElementById('amount').value = amountMatch[0];
                    convertCurrency();
                } else {
                    alert('Could not recognize a valid number. Please try again.');
                }
            };
            recognition.onerror = (event) => {
                console.error('Speech recognition error:', event.error);
                alert('Error during speech recognition: ' + event.error);
            };
            recognition.onend = () => {
                document.querySelector('.voice-btn').style.backgroundColor = '#ff6f61';
            };
            recognition.start();
        }

        function speakResult() {
            const resultText = document.getElementById('result').textContent;
            if (!resultText || resultText.includes('Error')) {
                return;
            }
            const utterance = new SpeechSynthesisUtterance(resultText);
            utterance.lang = 'en-US';
            utterance.rate = 1;
            utterance.pitch = 1;
            window.speechSynthesis.speak(utterance);
        }

        // Auto-convert on input change
        document.getElementById('amount').addEventListener('input', convertCurrency);
        document.getElementById('fromCurrency').addEventListener('change', convertCurrency);
        document.getElementById('toCurrency').addEventListener('change', convertCurrency);

        // Initial fetch
        fetchCurrencies();
    </script>
</body>
</html>
